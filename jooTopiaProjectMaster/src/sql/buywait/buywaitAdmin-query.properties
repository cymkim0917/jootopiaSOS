selectList=SELECT PC.PCID, PCD.PCDID,PCD.STATUS, PCD.PBARCODE, PCD.APPLY_DENY_REASON, PCD.DENY_REASON, PCD.PCPRICE, PCD.MESSAGE, PCD.PCDATE, PC.APPLICANT, PC.APPLICANT_ADDRESS, PC.APPLICANT_DISTANCE, PC.APPLICANT_PHONE, C.CID, C.CGROUP, C.NAME, C.MAX_AMOUNT FROM PURCHASE_DETAIL PCD JOIN PURCHASE PC ON (PCD.PCID = PC.PCID) JOIN CATEGORY C ON (PC.CID = C.CID) LEFT JOIN PRODUCT P ON(P.PCDID = PCD.PCDID) WHERE P.PID IS NULL AND PCD.STATUS IN (?, ?, ?, ?) ORDER BY PC.PCID DESC, PCD.PCDID ASC
selectListAfterPaging=SELECT RNUM, PCID, PCDID,STATUS, PBARCODE, APPLY_DENY_REASON, DENY_REASON, PCPRICE, MESSAGE, PCDATE, APPLICANT, APPLICANT_ADDRESS, APPLICANT_DISTANCE, APPLICANT_PHONE, CID, CGROUP, NAME, MAX_AMOUNT FROM (SELECT ROWNUM RNUM, PCID, PCDID, STATUS, PBARCODE, APPLY_DENY_REASON, DENY_REASON, PCPRICE, MESSAGE, PCDATE, APPLICANT, APPLICANT_ADDRESS, APPLICANT_DISTANCE, APPLICANT_PHONE, CID, CGROUP, NAME, MAX_AMOUNT FROM(SELECT PC.PCID, PCD.PCDID,PCD.STATUS, PCD.PBARCODE, PCD.APPLY_DENY_REASON, PCD.DENY_REASON, PCD.PCPRICE, PCD.MESSAGE, PCD.PCDATE, PC.APPLICANT, PC.APPLICANT_ADDRESS, PC.APPLICANT_DISTANCE, PC.APPLICANT_PHONE, C.CID, C.CGROUP, C.NAME, C.MAX_AMOUNT FROM PURCHASE_DETAIL PCD JOIN PURCHASE PC ON (PCD.PCID = PC.PCID) JOIN CATEGORY C ON (PC.CID = C.CID) LEFT JOIN PRODUCT P ON(P.PCDID = PCD.PCDID) WHERE P.PID IS NULL AND PCD.PCDID = (SELECT MAX(PCDID) FROM PURCHASE_DETAIL WHERE PCID = PCD.PCID) ORDER BY PC.PCID DESC, PCD.PCDID ASC)) WHERE RNUM BETWEEN ? AND ?
listCount=SELECT COUNT(*) FROM PURCHASE_DETAIL PCD JOIN PURCHASE PC ON (PCD.PCID = PC.PCID) JOIN CATEGORY C ON (PC.CID = C.CID) LEFT JOIN PRODUCT P ON(P.PCDID = PCD.PCDID) WHERE P.PID IS NULL ORDER BY PC.PCID DESC, PCD.PCDID ASC